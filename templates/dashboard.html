<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Adolescent Health Analytics Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-gradient-primary">
        <div class="container-fluid px-4">
            <a class="navbar-brand" href="/">
                <i class="fas fa-chart-line"></i> Adolescent Health Analytics
            </a>
        </div>
    </nav>

    <div class="container-fluid px-4">
        <!-- Hero Section -->
        <div class="hero-section text-center">
            <h1 class="display-4 mb-3">
                <i class="fas fa-heartbeat text-danger"></i> 
                Adolescent Concern Analysis Dashboard
            </h1>
            <p class="lead text-muted">
                Understanding the impact of unhealthy food advertising on adolescent health concerns
            </p>
        </div>

        <!-- Key Metrics Row -->
        <div class="row mb-4">
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card metric-primary">
                    <div class="metric-icon">
                        <i class="fas fa-database"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value">{{ total_records }}</h3>
                        <p class="metric-label">Total Records</p>
                        <div class="metric-footer">
                            <small><i class="fas fa-users"></i> Adolescents Analyzed</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card metric-danger">
                    <div class="metric-icon">
                        <i class="fas fa-exclamation-triangle"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value">{{ concern_distribution.get('High', 0) }}</h3>
                        <p class="metric-label">High Concern</p>
                        <div class="metric-footer">
                            <small><i class="fas fa-percentage"></i> {{ high_concern_pct }}% of Total</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card metric-warning">
                    <div class="metric-icon">
                        <i class="fas fa-info-circle"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value">{{ concern_distribution.get('Medium', 0) }}</h3>
                        <p class="metric-label">Medium Concern</p>
                        <div class="metric-footer">
                            <small><i class="fas fa-balance-scale"></i> Moderate Risk</small>
                        </div>
                    </div>
                </div>
            </div>
            <div class="col-lg-3 col-md-6 mb-3">
                <div class="metric-card metric-success">
                    <div class="metric-icon">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="metric-content">
                        <h3 class="metric-value">{{ concern_distribution.get('Low', 0) }}</h3>
                        <p class="metric-label">Low Concern</p>
                        <div class="metric-footer">
                            <small><i class="fas fa-smile"></i> Healthy Status</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Filters Section -->
        <div class="card shadow-sm mb-4">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-filter"></i> Data Filters & Controls</h5>
            </div>
            <div class="card-body">
                <form method="POST">
                    <div class="row align-items-end">
                        <div class="col-md-3 mb-3">
                            <label for="age_min" class="form-label">
                                <i class="fas fa-calendar-minus"></i> Minimum Age
                            </label>
                            <input type="number" id="age_min" name="age_min" value="{{ age_min }}" 
                                   min="13" max="18" class="form-control">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="age_max" class="form-label">
                                <i class="fas fa-calendar-plus"></i> Maximum Age
                            </label>
                            <input type="number" id="age_max" name="age_max" value="{{ age_max }}" 
                                   min="13" max="18" class="form-control">
                        </div>
                        <div class="col-md-3 mb-3">
                            <label for="gender" class="form-label">
                                <i class="fas fa-users"></i> Gender
                            </label>
                            <select id="gender" name="gender" class="form-control">
                                <option value="All" {% if gender == 'All' %}selected{% endif %}>All Genders</option>
                                <option value="Male" {% if gender == 'Male' %}selected{% endif %}>Male</option>
                                <option value="Female" {% if gender == 'Female' %}selected{% endif %}>Female</option>
                            </select>
                        </div>
                        <div class="col-md-3 mb-3">
                            <button type="submit" class="btn btn-primary btn-block">
                                <i class="fas fa-search"></i> Apply Filters
                            </button>
                        </div>
                    </div>
                </form>
            </div>
        </div>

        <!-- Analytics Section -->
        <div class="row mb-4">
            <div class="col-12">
                <h2 class="section-title">
                    <i class="fas fa-chart-bar"></i> Data Analytics & Visualizations
                </h2>
            </div>
        </div>

        <!-- Charts Row 1 -->
        <div class="row mb-4">
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm chart-card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-chart-pie"></i> Concern Level Distribution</h5>
                        <small class="text-muted">Overall distribution of health concerns</small>
                    </div>
                    <div class="card-body text-center">
                        <img src="data:image/png;base64,{{ concern_plot }}" alt="Concern Distribution" class="img-fluid chart-img">
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm chart-card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-star"></i> Top Feature Importances</h5>
                        <small class="text-muted">Most influential factors in predictions</small>
                    </div>
                    <div class="card-body text-center">
                        <img src="data:image/png;base64,{{ importances_plot }}" alt="Feature Importances" class="img-fluid chart-img">
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row 2 -->
        <div class="row mb-4">
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm chart-card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-birthday-cake"></i> Age Distribution Analysis</h5>
                        <small class="text-muted">Age patterns across concern levels</small>
                    </div>
                    <div class="card-body text-center">
                        <img src="data:image/png;base64,{{ age_dist_plot }}" alt="Age Distribution" class="img-fluid chart-img">
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm chart-card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-venus-mars"></i> Gender-Based Analysis</h5>
                        <small class="text-muted">Concern levels by gender</small>
                    </div>
                    <div class="card-body text-center">
                        <img src="data:image/png;base64,{{ gender_plot }}" alt="Gender Analysis" class="img-fluid chart-img">
                    </div>
                </div>
            </div>
        </div>

        <!-- Charts Row 3 -->
        <div class="row mb-4">
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm chart-card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-tv"></i> Ad Exposure Impact</h5>
                        <small class="text-muted">How advertising affects concern levels</small>
                    </div>
                    <div class="card-body text-center">
                        <img src="data:image/png;base64,{{ ad_exposure_plot }}" alt="Ad Exposure" class="img-fluid chart-img">
                    </div>
                </div>
            </div>
            <div class="col-lg-6 mb-4">
                <div class="card shadow-sm chart-card">
                    <div class="card-header">
                        <h5 class="mb-0"><i class="fas fa-project-diagram"></i> Feature Correlation Matrix</h5>
                        <small class="text-muted">Relationships between variables</small>
                    </div>
                    <div class="card-body text-center">
                        <img src="data:image/png;base64,{{ correlation_plot }}" alt="Correlation" class="img-fluid chart-img">
                    </div>
                </div>
            </div>
        </div>

        <!-- Prediction Form -->
        <div class="row mb-5">
            <div class="col-12">
                <h2 class="section-title">
                    <i class="fas fa-brain"></i> AI Prediction Engine
                </h2>
            </div>
        </div>

        <div class="card shadow-lg mb-5 prediction-card">
            <div class="card-header">
                <h5 class="mb-0"><i class="fas fa-magic"></i> Predict Adolescent Concern Level</h5>
                <small class="text-muted">Enter individual characteristics for AI-powered analysis</small>
            </div>
            <div class="card-body">
                <form action="/predict" method="POST">
                    <div class="row">
                        <div class="col-12 mb-3">
                            <h6 class="form-section-title"><i class="fas fa-user-circle"></i> Personal Information</h6>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <label for="age" class="form-label">
                                <i class="fas fa-birthday-cake"></i> Age <span class="text-danger">*</span>
                            </label>
                            <input type="number" id="age" name="age" min="13" max="18" 
                                   required class="form-control" placeholder="13-18">
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <label for="gender_predict" class="form-label">
                                <i class="fas fa-user"></i> Gender <span class="text-danger">*</span>
                            </label>
                            <select id="gender_predict" name="gender" required class="form-control">
                                <option value="">Select...</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                            </select>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <label for="parental_education" class="form-label">
                                <i class="fas fa-graduation-cap"></i> Parental Education
                            </label>
                            <select id="parental_education" name="parental_education" class="form-control">
                                <option value="High School">High School</option>
                                <option value="Bachelor" selected>Bachelor</option>
                                <option value="Master">Master</option>
                                <option value="PhD">PhD</option>
                            </select>
                        </div>
                        <div class="col-md-6 col-lg-3 mb-3">
                            <label for="ad_exposure_freq" class="form-label">
                                <i class="fas fa-tv"></i> Ad Exposure
                            </label>
                            <select id="ad_exposure_freq" name="ad_exposure_freq" class="form-control">
                                <option value="Low">Low</option>
                                <option value="Medium" selected>Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12 mb-3">
                            <h6 class="form-section-title"><i class="fas fa-heartbeat"></i> Health & Influence Factors</h6>
                        </div>
                        <div class="col-md-6 col-lg-4 mb-3">
                            <label for="health_knowledge" class="form-label">
                                <i class="fas fa-book-medical"></i> Health Knowledge
                            </label>
                            <select id="health_knowledge" name="health_knowledge" class="form-control">
                                <option value="Low">Low</option>
                                <option value="Medium" selected>Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                        <div class="col-md-6 col-lg-4 mb-3">
                            <label for="parental_influence" class="form-label">
                                <i class="fas fa-hands-helping"></i> Parental Influence
                            </label>
                            <select id="parental_influence" name="parental_influence" class="form-control">
                                <option value="Low">Low</option>
                                <option value="Medium" selected>Medium</option>
                                <option value="High">High</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-12 mb-3">
                            <h6 class="form-section-title"><i class="fas fa-bullhorn"></i> Advertisement Exposure Types</h6>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="custom-control custom-switch custom-switch-lg">
                                <input type="checkbox" class="custom-control-input" id="ad_type_celebrity" 
                                       name="ad_type_celebrity" value="1">
                                <label class="custom-control-label" for="ad_type_celebrity">
                                    <i class="fas fa-star text-warning"></i> Celebrity Endorsement
                                </label>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="custom-control custom-switch custom-switch-lg">
                                <input type="checkbox" class="custom-control-input" id="ad_type_free_toys" 
                                       name="ad_type_free_toys" value="1">
                                <label class="custom-control-label" for="ad_type_free_toys">
                                    <i class="fas fa-gift text-danger"></i> Free Toys/Gifts
                                </label>
                            </div>
                        </div>
                        <div class="col-md-4 mb-3">
                            <div class="custom-control custom-switch custom-switch-lg">
                                <input type="checkbox" class="custom-control-input" id="ad_type_cartoon" 
                                       name="ad_type_cartoon" value="1">
                                <label class="custom-control-label" for="ad_type_cartoon">
                                    <i class="fas fa-smile-beam text-info"></i> Cartoon Characters
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center mt-4">
                        <button type="submit" class="btn btn-success btn-lg btn-predict">
                            <i class="fas fa-magic"></i> Generate AI Prediction
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer py-4">
        <div class="container text-center">
            <p class="mb-2"><i class="fas fa-shield-alt"></i> <strong>Adolescent Health Analytics Platform</strong></p>
            <p class="mb-0 text-muted">&copy; 2025 Powered by Advanced Machine Learning & AI | Built with <i class="fas fa-heart text-danger"></i></p>
        </div>
    </footer>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Convert checkboxes to proper values
        document.querySelector('form[action="/predict"]').addEventListener('submit', function(e) {
            ['ad_type_celebrity', 'ad_type_free_toys', 'ad_type_cartoon'].forEach(function(id) {
                var checkbox = document.getElementById(id);
                if (!checkbox.checked) {
                    var hidden = document.createElement('input');
                    hidden.type = 'hidden';
                    hidden.name = id;
                    hidden.value = '0';
                    this.appendChild(hidden);
                }
            }, this);
        });

        // Add smooth scrolling
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                document.querySelector(this.getAttribute('href')).scrollIntoView({
                    behavior: 'smooth'
                });
            });
        });
    </script>
</body>
</html>